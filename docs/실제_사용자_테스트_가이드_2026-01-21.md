# 🚀 실제 사용자 테스트 가이드

**작성일**: 2026-01-21  
**목적**: Vercel 배포 후 실제 앱에서 하이브리드 시스템 테스트  
**상태**: ✅ 테스트 준비 완료

---

## 📱 테스트 방법

### 1. 앱 접속

**URL**: `https://mkm-study20260120.vercel.app/`

**브라우저**: Chrome 또는 Edge (Web Speech API 지원)

---

### 2. Nitro Test (로컬 우선) - PC 켜짐 상태

#### 준비
- ✅ 로컬 PC 24시간 가동 중
- ✅ Ollama 서비스 실행 중 (`http://localhost:11434`)
- ✅ 브라우저 개발자 도구 열기 (F12)

#### 테스트 절차

1. **앱 접속 후 "질문" 탭 클릭**
2. **마이크 버튼 클릭 (Push-to-Talk)**
3. **질문**: "비트코인 전망해봐."
4. **콘솔 로그 확인** (F12 → Console 탭)

#### 확인 사항

**콘솔 로그에서 확인**:
```
[API] 하이브리드 Ollama 전략 활성화 (로컬 우선 → VPS 폴백)
[Ollama] 로컬 연결 성공, 로컬 우선 사용
[Gemma3 Streaming] 요청 시작: { 
  prompt: '비트코인 전망해봐.', 
  url: 'http://localhost:11434', 
  model: 'athena-merged-v1:latest' 
}
```

**성능 측정**:
- 첫 토큰 시작 시간: **3-4초** (예상)
- 전체 응답 완료: **5-10초** (예상, 질문 복잡도에 따라 다름)

**성공 기준**:
- ✅ 로컬 연결 성공 메시지 확인
- ✅ `athena-merged-v1:latest` 모델 사용 확인
- ✅ 응답이 10초 내에 시작됨

---

### 3. Survival Test (VPS 폴백) - PC 꺼짐 상태

#### 준비
- ⚠️ 로컬 PC의 Ollama 서비스 중지 (또는 Tailscale 종료)
- ✅ VPS Ollama 서비스 실행 중 (확인 필요)

#### 테스트 절차

1. **로컬 연결 차단**:
   ```powershell
   # 방법 1: Ollama 서비스 중지
   # 방법 2: 방화벽에서 localhost:11434 차단
   # 방법 3: Tailscale 종료 (외부 접근 시)
   ```

2. **브라우저 새로고침** (캐시 초기화)
3. **앱 접속 후 "질문" 탭 클릭**
4. **마이크 버튼 클릭**
5. **질문**: "지금 내 기분 어때?"
6. **콘솔 로그 확인**

#### 확인 사항

**콘솔 로그에서 확인**:
```
[API] 하이브리드 Ollama 전략 활성화 (로컬 우선 → VPS 폴백)
[Ollama] 로컬 연결 실패, VPS 폴백: AbortError: The operation was aborted
[Ollama] VPS 사용: http://148.230.97.246:11434
[Gemma3 Streaming] 요청 시작: { 
  prompt: '지금 내 기분 어때?', 
  url: 'http://148.230.97.246:11434', 
  model: 'gemma3:4b' 
}
```

**성능 측정**:
- 타임아웃 지연: **1초** (로컬 실패 감지)
- 첫 토큰 시작: **2-5초** (VPS 네트워크 지연)
- 전체 응답 완료: **5-15초**

**성공 기준**:
- ✅ 로컬 실패 메시지 확인
- ✅ VPS 폴백 성공 확인
- ✅ `gemma3:4b` 모델 사용 확인
- ✅ 서비스 중단 없음 (응답 받음)

---

## 📊 실제 측정 결과 (로컬)

### 로컬 Ollama 성능

| 항목 | 측정값 | 비고 |
|------|--------|------|
| **연결 시간** | 2.1초 | 모델 목록 조회 |
| **첫 토큰 (TTFT)** | 3.7초 | 모델 로드 완료 후 |
| **전체 응답** | 3.7초 | 180자 응답 |
| **모델** | athena-merged-v1:latest | 8B |

**분석**:
- 첫 요청: 8.1초 (모델 로드 포함)
- 두 번째 요청: 3.7초 (모델 로드 완료 후)
- **예상 실제 사용**: 3-5초 (스트리밍 모드)

---

## ⚠️ 주의사항

### VPS 상태

**현재 문제**:
- VPS Ollama 서버 연결 실패
- 가능한 원인:
  1. 서버 다운
  2. 방화벽 설정
  3. 네트워크 문제

**권장 조치**:
- VPS 서버 상태 확인 필요
- 폴백 테스트는 서버 복구 후 진행

### 로컬 성능

**현재 측정값**:
- 첫 토큰: 3.7초 (예상보다 느림)
- 가능한 원인:
  1. GPU 미사용 (CPU 모드)
  2. 모델 워밍업 미완료
  3. 첫 요청 오버헤드

**개선 방안**:
- GPU 사용 확인 (`nvidia-smi`로 확인)
- 모델 워밍업 스크립트 실행 (선택적)

---

## ✅ 체크리스트

### Nitro Test (로컬)

- [ ] 브라우저 콘솔 열기 (F12)
- [ ] 질문 입력: "비트코인 전망해봐."
- [ ] 콘솔 로그에서 로컬 연결 확인
- [ ] 모델 `athena-merged-v1:latest` 사용 확인
- [ ] 첫 토큰 시작 시간 측정
- [ ] 전체 응답 완료 시간 측정

### Survival Test (VPS 폴백)

- [ ] 로컬 연결 차단
- [ ] 브라우저 새로고침
- [ ] 질문 입력: "지금 내 기분 어때?"
- [ ] 콘솔 로그에서 VPS 폴백 확인
- [ ] 모델 `gemma3:4b` 사용 확인
- [ ] 서비스 중단 없음 확인

---

## 🎯 최종 판정 기준

### 성능 기준

- ✅ 로컬 첫 토큰 < 5초
- ✅ 로컬 전체 응답 < 10초
- ✅ VPS 폴백 성공률 100%
- ✅ 서비스 중단 시간 0초

### 안정성 기준

- ✅ 로컬 실패 시 자동 VPS 전환
- ✅ VPS 실패 시 명확한 에러 메시지
- ✅ 30초 캐시로 성능 최적화

---

**작성일**: 2026-01-21  
**상태**: ✅ 테스트 가이드 준비 완료  
**다음 단계**: 실제 브라우저에서 테스트 실행

[Verified by Athena Auditor v1.2]

