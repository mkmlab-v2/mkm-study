# 🚀 다음 단계 실행 가이드

**작성일**: 2026-01-20  
**프로젝트**: mkm-study20260120  
**상태**: ✅ 커리큘럼 맵 구축 완료, Athena Generator 준비 완료

---

## ✅ 완료된 작업

1. **커리큘럼 맵 구축 완료**
   - 63개 단원, 159개 주제
   - 저장 위치: `learning-content/curriculum/curriculum_map.json`

2. **Athena Generator 스크립트 준비 완료**
   - Gemma3 연결 수정 완료 (포트 11434)
   - 문제 생성 테스트 성공 (약 49초 소요)
   - VPS API 저장 실패 (404) - 서버 배포 필요

---

## 🎯 다음 단계 (우선순위 순)

### 1단계: VPS API 서버 배포 (최우선) ⭐

**목적**: 생성된 문제를 VPS에 저장할 수 있도록 API 서버 배포

**방법 1: PowerShell 스크립트 사용 (권장)**
```powershell
cd C:\workspace\projects\mkm\mkm-study20260120
.\scripts\deploy-learning-api-vps.ps1
```

**방법 2: 수동 배포**
```bash
# VPS에 SSH 접속
ssh root@148.230.97.246

# 디렉토리 생성
mkdir -p /var/www/mkm-study/backend
mkdir -p /var/www/mkm-study/learning-content

# 파일 전송 (로컬에서 실행)
scp backend/learning_content_api.py root@148.230.97.246:/var/www/mkm-study/backend/

# VPS에서 의존성 설치
cd /var/www/mkm-study/backend
pip3 install fastapi uvicorn pydantic

# API 서버 실행 (백그라운드)
nohup python3 learning_content_api.py > learning_api.log 2>&1 &

# 서버 상태 확인
curl http://148.230.97.246:8003/
```

**확인 사항**:
- ✅ API 서버가 `http://148.230.97.246:8003/`에서 응답하는지 확인
- ✅ `/api/v1/learning/store` 엔드포인트가 작동하는지 확인

---

### 2단계: 기출문제 다운로더 실행 (선택적)

**목적**: Ground Truth 데이터셋 구축

**실행 방법**:
```powershell
cd C:\workspace\projects\mkm\mkm-study20260120
py scripts\download_kice_exams.py
```

**주의사항**:
- PDF 다운로드는 사용자 확인 필요
- 대량 다운로드 시 시간 소요 (최근 10년치)

**결과**:
- `learning-content/kice-exams/pdfs/`: PDF 원본
- `learning-content/kice-exams/texts/`: 텍스트 변환본
- `learning-content/kice-exams/metadata/exam_metadata.json`: 메타데이터

---

### 3단계: Athena Generator 대량 문제 생성

**목적**: 맞춤형 문제 무한 생성

**실행 방법**:
```powershell
# 중2 수학 문제 생성 (단원당 3개)
py scripts\athena_generator.py math 중2 None 3

# 고1 영어 문제 생성 (단원당 5개)
py scripts\athena_generator.py english 고1 태양인 5
```

**주의사항**:
- Gemma3 응답 시간: 약 49초/문제
- 대량 생성 시 시간 소요 (9개 단원 × 3문제 = 약 22분)

**결과**:
- `learning-content/generated-problems/{grade}_{subject}_problems_{date}.json`
- VPS API에 자동 저장 (서버 배포 후)

---

## 📊 현재 상태

### ✅ 완료
- [x] 커리큘럼 맵 구축 (63개 단원, 159개 주제)
- [x] Athena Generator 스크립트 생성
- [x] Gemma3 연결 수정 완료
- [x] 문제 생성 테스트 성공

### ⏳ 진행 중
- [ ] VPS API 서버 배포
- [ ] 생성된 문제 VPS 저장 검증

### 📋 대기 중
- [ ] 기출문제 다운로더 실행
- [ ] 대량 문제 생성
- [ ] 학습 콘텐츠 벡터화

---

## 🔧 기술적 이슈

### 1. Gemma3 응답 시간
- **현재**: 약 49초/문제
- **원인**: VPS Gemma3 모델 처리 시간
- **해결책**: 
  - 프롬프트 단순화 (완료)
  - 타임아웃 60초로 증가 (완료)
  - 배치 처리 고려 (향후)

### 2. VPS API 서버 404 오류
- **원인**: VPS에 API 서버가 배포되지 않음
- **해결책**: VPS 배포 스크립트 실행 필요

### 3. Gemini API 400 오류
- **원인**: API 키 문제 또는 프롬프트 형식 문제
- **현재**: Gemma3로 우회 (정상 작동)

---

## 🎯 권장 실행 순서

1. **VPS API 서버 배포** (최우선) ⭐
   ```powershell
   .\scripts\deploy-learning-api-vps.ps1
   ```

2. **Athena Generator 테스트** (소량)
   ```powershell
   py scripts\athena_generator.py math 중2 None 1
   ```

3. **기출문제 다운로더 실행** (선택적)
   ```powershell
   py scripts\download_kice_exams.py
   ```

4. **대량 문제 생성** (VPS API 배포 후)
   ```powershell
   py scripts\athena_generator.py math 중2 None 3
   ```

---

**작성일**: 2026-01-20  
**상태**: ✅ 가이드 작성 완료  
**다음**: VPS API 서버 배포 실행

[Verified by Athena Auditor v1.2]

